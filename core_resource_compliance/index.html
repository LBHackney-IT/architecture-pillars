<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/architecture-pillars/blog/rss.xml" title="Hackney Architecture Pillars Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/architecture-pillars/blog/atom.xml" title="Hackney Architecture Pillars Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Hackney Architecture Pillars" href="/architecture-pillars/opensearch.xml"><title data-react-helmet="true">Core AWS resources compliance checks | Hackney Architecture Pillars</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Core AWS resources compliance checks | Hackney Architecture Pillars"><meta data-react-helmet="true" name="description" content="Context"><meta data-react-helmet="true" property="og:description" content="Context"><meta data-react-helmet="true" property="og:url" content="https://github.com/LBHackney-IT/architecture-pillars/architecture-pillars/core_resource_compliance"><link data-react-helmet="true" rel="shortcut icon" href="/architecture-pillars/img/favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://github.com/LBHackney-IT/architecture-pillars/architecture-pillars/core_resource_compliance"><link rel="stylesheet" href="/architecture-pillars/styles.cd915cb9.css">
<link rel="stylesheet" href="/architecture-pillars/main.4a16e2e4.css">
<link rel="preload" href="/architecture-pillars/styles.236ca13f.js" as="script">
<link rel="preload" href="/architecture-pillars/runtime~main.df464c73.js" as="script">
<link rel="preload" href="/architecture-pillars/main.b9ce0366.js" as="script">
<link rel="preload" href="/architecture-pillars/1.ce94ebe6.js" as="script">
<link rel="preload" href="/architecture-pillars/2.4274d689.js" as="script">
<link rel="preload" href="/architecture-pillars/25.cb647df6.js" as="script">
<link rel="preload" href="/architecture-pillars/28.5c7bc7fe.js" as="script">
<link rel="preload" href="/architecture-pillars/935f2afb.d6275df2.js" as="script">
<link rel="preload" href="/architecture-pillars/17896441.3ebad724.js" as="script">
<link rel="preload" href="/architecture-pillars/a6fb8e91.89b7c418.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/architecture-pillars/"><img src="/architecture-pillars/img/logo-long.svg" alt="Architecture Pillars" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/architecture-pillars/img/logo-long.svg" alt="Architecture Pillars" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Architecture Pillars</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/architecture-pillars" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/architecture-pillars/"><img src="/architecture-pillars/img/logo-long.svg" alt="Architecture Pillars" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/architecture-pillars/img/logo-long.svg" alt="Architecture Pillars" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Architecture Pillars</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/LBHackney-IT/architecture-pillars" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/architecture-pillars/">Introduction</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Architecture Pillars</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Reliabilty</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/architecture-pillars/production_deployment">Production Deployment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/architecture-pillars/preferred_data_source">Preferred types of databases and when to use</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/architecture-pillars/core_resource_compliance">Core AWS resources compliance checks</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Scalibility</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/preferred_data_source">Preferred types of databases and when to use</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/auto_scaling">Auto-scaling for AWS resources used in Software Engineering</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Security</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/architecture-pillars/core_resource_compliance">Core AWS resources compliance checks</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Cost Optimisation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/auto_scaling">Auto-scaling for AWS resources used in Software Engineering</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">High Availability and Performance</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/preferred_data_source">Preferred types of databases and when to use</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Development Principles and Quality Assurance</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/testing_standards">HackIT Testing Standards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/data_driven">HackIT Data Driven Guidelines</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/api_compliance">API Compliance Checklist</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/qa_process">Enhancing the Quality Assurance process in Hackney through the use of automation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/repository_standards">Managing our GitHub repositories’ branches</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/minimum_qa_standard">Minimum QA testing requirements in Hackney’s Software Development Lifecycle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/developer_onboarding">Developer technical on-boarding</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/data_modelling">Data Modelling Principles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/adr">Architecture Decision Records</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/api_spec_asessment_process">API Specifications Assessment Process</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/architecture-pillars/data_meetup_template">Data Meetup Template</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/architecture-pillars/contact_us">Contact Our Development Team</a></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Core AWS resources compliance checks</h1></header><div class="markdown"><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="context"></a>Context<a class="hash-link" href="#context" title="Direct link to heading">#</a></h3><p>At Hackney, we follow an infrastructure-as-code (IaC) approach and use Terraform to provision most of our AWS cloud resources. For our APIs, which are Lambda functions exposed via AWS API Gateway, we use the Serverless framework as it significantly speeds up the delivery and resource creation.  For more information please refer to <a href="https://playbook.hackney.gov.uk/API-Playbook/" target="_blank" rel="noopener noreferrer">our playbook</a>.</p><p>From a Development perspective, each project manages its own Terraform files(or Serverless configuration) to provision resources for our microservices and frontend applications. Terraform is then applied automatically as part of the CI/CD pipeline workflow during deployment. </p><p>As Terraform files live in the same repository as the service, for which they are used to create cloud resources, we use our Pull Request process to identify any potential issues with changes to AWS resources or the configuration for adding new ones. Despite having a very thorough pull request process, there is still room for error if something gets missed during a review. </p><p>To ensure we have security assurance in every step, we started using terraform-compliance -  a security and compliance test framework, and Serverless Safeguards to assess if changes are compliant with a predefined set of compliance rules and terminate deployment in case of a failure. </p><p>This document aims to outline the core compliance checks that <strong>must</strong> be performed for the various AWS resources provisioned as part of the Software Delivery Lifecycle <strong>only</strong> and not the wider platform. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="resources"></a>Resources<a class="hash-link" href="#resources" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="ec2"></a>EC2<a class="hash-link" href="#ec2" title="Direct link to heading">#</a></h3><p>Terraform compliance checks:</p><ol><li>EC2 instances must be placed in a private subnet.</li><li>Default tags are present. [INSERT LINK TO DEFAULT TAGS]</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="api-gateway"></a>API Gateway<a class="hash-link" href="#api-gateway" title="Direct link to heading">#</a></h3><p>Serverless safeguards policies:</p><ol><li>Require Lambda authorizer for all API endpoints exposed by API Gateway with the exception of Swagger endpoints. <ul><li>Example implementation <a href="https://github.com/LBHackney-IT/asset-information-api/pull/51/files" target="_blank" rel="noopener noreferrer">here</a>.</li></ul></li><li>Ensure cors is enabled.</li><li>WAF is enabled.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="dynamodb"></a>DynamoDB<a class="hash-link" href="#dynamodb" title="Direct link to heading">#</a></h3><ol><li>PITR is enabled.</li><li>Back up tags are present.</li><li>Maximum number of GSIs is two.</li><li>Encryption is enabled.</li><li>Default tags are present. [INSERT LINK TO DEFAULT TAGS]</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="sns"></a>SNS<a class="hash-link" href="#sns" title="Direct link to heading">#</a></h3><ol><li>Encryption is enabled</li><li>Topic is FIFO</li><li>Default tags are present. [INSERT LINK TO DEFAULT TAGS]</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="opensearch-elasticsearch"></a>OpenSearch (ElasticSearch)<a class="hash-link" href="#opensearch-elasticsearch" title="Direct link to heading">#</a></h3><ol><li>Deployed in a VPC</li><li>Deployed to a private subnet.</li><li>Clusters are encrypted at rest.</li><li>Minimum instance size is 2.</li><li>Instance type is small or medium.</li><li>Default tags are present. [INSERT LINK TO DEFAULT TAGS]</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="sqs"></a>SQS<a class="hash-link" href="#sqs" title="Direct link to heading">#</a></h3><ol><li>Encryption is enabled.</li><li>Dead letter queue is set up.</li><li>Queue is FIFO.</li><li>Default tags are present. [INSERT LINK TO DEFAULT TAGS]</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="rds"></a>RDS<a class="hash-link" href="#rds" title="Direct link to heading">#</a></h3><ol><li>Database is not publicly accessible.</li><li>Deployed to a private subnet.</li><li>Database engine is PostgreSQL</li><li>Database size is t3.micro, t3.small, t3.medium or t3.large</li><li>Database has multi-az deployment enabled (for production)</li><li>Encryption is enabled.</li><li>Default tags are present. [INSERT LINK TO DEFAULT TAGS]</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cloudfront"></a>CloudFront<a class="hash-link" href="#cloudfront" title="Direct link to heading">#</a></h3><ol><li>Distribution has WAF enabled.</li><li>Production uses Hackney’s certificate.</li><li>Price class is “PriceClass_100”.</li><li>Default tags are present. [INSERT LINK TO DEFAULT TAGS]</li><li>The following headers are whitelisted:<ul><li>Origin</li><li>Access-Control-Request-Headers</li><li>Access-Control-Request-Method</li></ul></li><li>Query strings are forwarded.</li></ol></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/LBHackney-IT/architecture-pillars/edit/master/docs/core_resource_compliance.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/architecture-pillars/preferred_data_source"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Preferred types of databases and when to use</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/architecture-pillars/preferred_data_source"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Preferred types of databases and when to use »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#context" class="table-of-contents__link">Context</a></li><li><a href="#resources" class="table-of-contents__link">Resources</a><ul><li><a href="#ec2" class="table-of-contents__link">EC2</a></li><li><a href="#api-gateway" class="table-of-contents__link">API Gateway</a></li><li><a href="#dynamodb" class="table-of-contents__link">DynamoDB</a></li><li><a href="#sns" class="table-of-contents__link">SNS</a></li><li><a href="#opensearch-elasticsearch" class="table-of-contents__link">OpenSearch (ElasticSearch)</a></li><li><a href="#sqs" class="table-of-contents__link">SQS</a></li><li><a href="#rds" class="table-of-contents__link">RDS</a></li><li><a href="#cloudfront" class="table-of-contents__link">CloudFront</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/architecture-pillars/styles.236ca13f.js"></script>
<script src="/architecture-pillars/runtime~main.df464c73.js"></script>
<script src="/architecture-pillars/main.b9ce0366.js"></script>
<script src="/architecture-pillars/1.ce94ebe6.js"></script>
<script src="/architecture-pillars/2.4274d689.js"></script>
<script src="/architecture-pillars/25.cb647df6.js"></script>
<script src="/architecture-pillars/28.5c7bc7fe.js"></script>
<script src="/architecture-pillars/935f2afb.d6275df2.js"></script>
<script src="/architecture-pillars/17896441.3ebad724.js"></script>
<script src="/architecture-pillars/a6fb8e91.89b7c418.js"></script>
</body>
</html>